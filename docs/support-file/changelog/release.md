## [Version: v3.13.2-alpha1] - 2024-01-03
**新增功能**
- 首页主机搜索自动解析及样式优化

**功能优化**
- gsecmdline迁移到监控的上报
- 主机导出Excel时，管控区域字段带上ID
- 优化了一些前端的显示问题

**缺陷修复**
- 根据集群模板id查不到模块时返回业务所有服务实例
- 根据创建时间查询业务集没有查询出对应的业务集数据

## [Version: v3.13.1] - 2023-12-27
**新增功能**
- 新增空间级查看权限控制能力（请注意版本依赖：IAM SaaS >= 1.10.17）

**功能优化**
- 优化了一些前端的显示问题

## [Version: v3.12.4] - 2023-12-19
**功能优化**
- 优化了一些前端的显示问题
- 修改文档中心默认首页的地址
- 采用认证信息标准化方案调用esb API
- 更新bkDesktopUrl配置为bkComponentApiUrl配置

**缺陷修复**
- 修复设置agentID缓存数据错误问题
- 添加job资源限制
- 修复add_host_to_business_idle接口鉴权问题

## [Version: v3.12.3] - 2023-11-17
**新增功能**
- 主机搜索支持“多个管控区域IP”的混合搜索
- 模型分组下的模型支持拖拽修改顺序
- 创建默认业务集：“全业务-蓝盾测试部署专用”
- 模型增加创建时间、创建人、更新时间、修改人字段展示

**功能优化**
- 优化了一些前端的显示问题
- 处理模型默认字段、主机寻址方式国际化的问题
- 调整主机磁盘容量计算方式
- 表格字段模型不注册到权限中心
- 动态分组逻辑功能更新

**缺陷修复**
- 修复导出实例数据相关问题
- 修复容器主机拓扑展示与跳转问题
- 导入更新模型字段“日期”“时间”“用户”“时区”“列表”时报错
- 操作审计选择其他/资源,操作对象为“模型”“模型分组”“云账户”“云资源发现”查询出来的条件，点击进入详情报错
- 修复创建模型时偶现的注册权限中心重复的问题

## [Version: v3.12.2] - 2023-10-30
**功能优化**
- 优化了一些前端的显示问题
- 容器节点字段名称补充
- pod添加负责人字段
- 调整job消失时间和运行时机

**缺陷修复**
- 修复导入实例超过100条时报错导入重复的问题
- 修复删除redis数据失败导致数据积压的问题
- 修复容器接口鉴权问题

## [Version: v3.12.1] - 2023-10-10
**新增功能**
- 容器数据纳管功能

**缺陷修复**
- 修复map类型不一致导致索引重复创建的问题

## [Version: v3.11.2] - 2023-09-20
**功能优化**
- 优化了一些前端的显示问题
- excel导入导出重构
- 代码复杂度优化
- 将后端代码模型option的解析和校验逻辑统一为一套
- 删除模块和服务模板时，自动删除模块和模版上的主机自动应用
- 调整chart探针默认配置
- 主机身份下发时，对安装1.0agent的window机器的文件owner特殊处理

## [Version: v3.11.1] - 2023-08-04
**新增功能**
- 支持登录应用访问限制功能
- 新增字段组合模版功能
- 新增支持ipv6特性功能
- 新增支持表格字段功能
- 新增模型属性字段支持添加默认值的功能
- 模型字段新增枚举多选
- 新增对于云区域资源的watch功能
- 导航中添加语言切换功能
- 新增获取推送主机身份结果接口
- 新增项目模型功能

**功能优化**
- 优化了一些前端的显示问题
- 云区域专有名词优化
- 调整调用gse的thrift接口证书
- 组织类型字段支持多选
- 新增首页展示版本日志功能
- 创建数据库索引时兼容已经创建过的重复索引
- 优化主机磁盘容量的计算方式
- 云主机接口支持根据云供应商+云主机ID判断主机是否需要更新

**缺陷修复**
- 修复集群模版实例展示列表总数错误的问题
- 修复当不传模块ID时，服务实例查询接口查询失败的问题
- 修复无法通过excel导入模型的问题
- 修复当组织字段存在场景下，提示数据不存在的问题
- 修复新旧dataid向gse注册streamTo时互相影响的问题
- 修复删除模型属性字段场景下错误的获取主机自动应用规则的问题
- 修复更新服务模板接口校验名称按之前的名称校验的问题
- 修复调整模型字段接口业务自定义字段未按照业务判断的问题
- 修复导出用户数据时，临界数据丢失问题
- 修复创建字段分组不存在时没有创建默认分组的问题
- 修复excel导入关联关系时，未对关联关系映射进行校验的问题
- 修复用自定义拓扑的实例id查询主机时, 如果没有查到自定义拓扑实例导致查询死循环的问题
- 修复cmdb多环境场景下会概率性出现循环登陆问题
- 修复全文检索场景极小概率panic问题
- 修复进程模版相关接口鉴权时，查不到服务模版导致的鉴权问题
- 修复操作审计详情是否使用表格展示的问题
- 修复无法导入模型字段的问题
- 修复资源目录搜索时实例数量异常的问题
- 修复业务拓扑三级路由(主机详情)未正确展示无权限页面的问题
- 修复自定义字段页面获取唯一校验接口报错的问题
- 修复编辑服务模板时删除属性设置保存按钮不可用的问题
- 修复导出模型文件加密选项未生效的问题
- 自定义字段下编辑集群/模块/主机下的字段信息后会报错，但实际字段信息上已经修改成功

## [Version: v3.10.22] - 2022-11-10
**新增功能**
- 主机操作系统增加hp-unix类型

**功能优化**
- 对一些UI的体验问题进行了优化
- 对taskserver服务异步任务相关逻辑进行了优化
- 编译cmdb依赖的golang版本升级到1.17
- 新增云主机时，如果有内网IP+云区域和业务均相同的主机，则更新该主机

**缺陷修复**
- 修复设置平台信息处的xss问题
- 并发获取用户数据时，出现并发读写map导致webserver服务panic
- 修复当supplierAccount不为0时，在内置模型分组下创建模型失败问题
- 修复excel导入主机关联数据时，勾选部分模型出现报错问题
- 批量创建关联关系接口缺少相关参数，导致创建成功后，cmdb页面无法展示
- 修复当没有自定义层级时，调用查询主机及其对应topo接口报错问题

## [Version: v3.10.21] - 2022-09-28
**修复功能**
- 修复新建业务时不能同步创建平台管理中用户自定义模块的问题
- 修复资源目录中添加到导航不限制场景下内置模型失效的问题

## [Version: v3.10.20] - 2022-09-28
**修复功能**
- 修复在特殊场景下watch功能失效的问题

## [Version: v3.10.19] - 2022-09-27
**新增功能**
- 资源池主机转移到主机池或主机转移其他业务限制由空闲模块调整为空闲机池
- 添加bkDataToken配置用于新的调用链上报
- monstache的pod配置resources资源
- 向gse注册redis主机快照上报信息时支持配置redis sentinel密码
- 添加版本日志以及配置文件模版

**功能优化**
- 调整业务拓扑默认排序方式
- 将文档中的用户名密码相关信息去掉
- 删除chart password默认值, 要求密码启动时必填
- 日期与时间类型属性编辑保存交互优化
- 修改切换成go mod后的编译文档
- 优化当采集不到主机快照字段时会记录冗余的审计问题
- 优化一级服务分类名称成功后切换为查看态
- 优化包含/不包含/模糊操作符的名称和描述
- 主机属性自动应用统一使用批量编辑视图及其它交互体验优化
- cmdb 引入vendor进行管理包依赖的方式
- 优化当业务集名称重复时的文案提示
- 优化权限初始化常用操作

**缺陷修复**
- 修复动态分组选择"不等于"场景下异常报错
- 修复运营统计自定义实例统计设置枚举类型字段后无数据显示
- 修复权限迁移使用了GetInt64ByInterface解析string导致报错的问题
- 修改编译时的DOCS_DIR路径
- 修复当没有配置集群模版属性时，查询不到对应模版的实例
- 业务名称使用拓扑实例名称校验规则及添加主线模型统一判断方法
- 修复业务集列表无权限申请操作无法点击的问题
- 修复无进程模板场景下同步状态不准确问题
- 修复小窗登录地址
- 修改动态分组大于小于操作符为大于等于和小于等于，解决与接口数据校验不一致的问题
- 修复模型唯一校验无效字段时展示为空行的问题

## [Version: 3.10.18] - 2022-07-26
**新增功能**
- 集群模板添加服务模板支持按分类进行筛选
- 添加推送主机身份接口
- 增加支持服务模板和集群模板配置属性字段能力

**功能优化**
- 主机导出单个文件上限调整为3万条
- 兼容新版数字输入组件及数值类型字段配置修改时的保存事件优化
- 模板配置字段变更对比兼容数组等更多数据类型和升级vue-i18n兼容新的语法
- 优化权限注册逻辑

**缺陷修复**
- 修复服务模板配置主机自动应用场景下，通过api接口转移主机未能实现主机自动应用
- 模型导出步骤文案修复
- 修复自动应用当模块所属模板已配置规则时跳转查看的模板规则数据未更新问题
- 修复在新版组件库下业务拓扑树的缩进问题
- 修复模型导入关联关系选中异常和高级筛选收藏条件弹层被遮挡问题
- 修复侧滑在内嵌窗口中可能导致页面位移的问题
- 升级magicbox和login组件解决小窗登录展示异常问题
- 修复查询模型关联实例分页数据id超出上限的问题
- 动态分组的模块与集群名称模糊搜索支持直接输入字符
- 修改monstache默认镜像版本为v2.0.0
- 服务模板进程绑定IP允许为空

## [Version: 3.10.17] - 2022-06-21
**新增功能**
- 新增导入主机支持填写云区域
- 添加业务集的全文检索功能，不包含资源范围
- 新增统计每个业务下主机CPU数量的接口

**功能优化**
- 优化主机自动应用权限
- 导入主机提示文案优化
- 转主机优先从模版获取主机应用规则
- 修改默认业务集查询条件并优化error信息
- 修改业务集结构体运维人员字段名称为bk_biz_maintainer
- 查看服务模板接口增加对参数0的校验
- 调整获取esb用户列表的请求用户名长度
- 去除util.GetInt64ByInterface里将string转为int64的逻辑
- 修改thrift连接为短链去调用
- 设置hostid文件同步到机器时旧文件的备份名
- redis sentinel支持传入sentinel password

**缺陷修复**
- 修复主机转移模块场景下，如果涉及到新增服务实例，不能超过100的限制
- 修复审计数据因模型被删除而无法查看的问题
- 修复全文检索es数据无法删除问题
- 修复查询自定义层级节点下的主机失败的问题
- 修复自定义字段拥有编辑权限却无法编辑的问题
- 修复主备负责人在进行主机自动应用时，当修改目的负责人只有一个，并且属于原来一组负责人之一时，主机自动应用失效
- 修复事件监听偶现失败的问题

## [Version: 3.10.16] - 2022-05-17
**新增功能**
- 服务与集群模板实例列表页添加单个实例的删除入口
- 主机搜索的模块与集群名称支持模糊搜索
- 主机自动应用支持按服务模板配置及体验优化
- 新增模型导入导出功能
- 业务集支持关联
- 各组件http请求context新增timeout机制，避免请求长时间执行不退出
- 各服务支持https
- 查询主机及其对应topo增加自定义层级查询条件

**兼容性**
- 优化procserver中无长度限制或无分页的接口可能会造成性能问题，如用到该 [issue](https://github.com/TencentBlueKing/bk-cmdb/issues/5651) 中的接口，请按新的分页要求使用，否则接口调用会失败。

**功能优化**
- 服务模板进程信息加解锁按钮提示文案优化
- 去除主机列表中hover显示的跳转业务拓扑tips避免极端情况下遮挡跳转icon
- 设置不可编辑字段+IPv6字段+CPU架构字段不可用于主机自动应用
- 适配接口分页限制
- 主机详情页的服务实例标签与拓扑显示优化为直接全部显示
- 业务(集)选择器交互体验优化
- 服务模板的进程端口字段配置默认锁定

**缺陷修复**
- 修复模型实例审计详情查看报错的问题
- 修复业务集视图下主机自动应用状态展示错误和拓扑地址参数合法性检查
- 修复编辑业务集业务范围未生效的问题
- 修复新建的模型字段分组无法正常折叠的问题
- 修复服务模板同步实例变更对比溢出文本样式和创建拓扑节点中的下拉框触发失效的问题
- 修复search_instance_associations不支持双向查询关联关系

## [Version: 3.10.15] - 2022-04-25
**新增功能**
- 添加内置BlueKing全业务的业务集，禁止删除它以及更新资源范围

**功能优化**
- 兼容gse的注册stream接口变动

**缺陷修复**
- 修复watch主机删除事件时ip为数组类型的问题
- 修复更新主机事务问题

## [Version: 3.10.14] - 2022-04-13
**功能优化**
- 调整mongo最大连接数为3000
- 调整opensource和skip-login登录方式是否调用esb接口的判断方式
- 云区域名称的唯一索引调整为新版本的形式
- 优化批量更新主机属性接口
- 集群模板确认同步按钮添加loading防止重复操作
- 平台管理主机池和业务空闲机池解耦
- 服务实例的端口和协议信息校验和进程模板中的校验规则保持一致
- 调整索引同步逻辑
- 获取服务实例同步差异时，没有传进程模板ID则对比全部进程模板的差异
- 超时等原因造成context被取消时，不调用取消事务接口，因为此时事务已失败退出
- 调整刷新主机id缓存逻辑

**缺陷修复**
- 修复模型实例审计详情查看报错的问题
- 国际化相关问题修复
- 修复业务集拓扑根节点loading状态异常问题
- 去除错误的通用模型的导出权限设置
- 修复删除模型属性时该模型属性为唯一校验报错未返回问题
- 修复导出主机关联关系时报错问题
- 修复业务集下空模块集群出现创建模块按钮的问题
- 修复因为map并发读写导致的同步服务模板失败的问题

## [Version: 3.10.13] - 2022-03-16
**新增功能**
- 增加支持更改模型分组能力
- 添加内外网IPv6字段和agent id字段
- 添加服务实例审计

**功能优化**
- 同步主机身份添加metrics采集
- 添加业务集和业务关系事件监听功能
- 优化模型编辑
- 优化主机自动应用性能

**缺陷修复**
- 修复dataid注册失败的问题

## [Version: 3.10.12] - 2022-03-02
**新增功能**
- datacollection主机静态数据上报支持kafka
- 新增支持业务集管理功能形态
- resource_watch接口添加业务集的事件监听功能

**功能优化**
- 优化主机自动应用性能
- adminserver迁移权限时查询模型的操作改为从db获取

## [Version: 3.10.11] - 2022-02-28
**新增功能**
- 新增根据主机id查询对应服务模版实例id的接口
- 导出excel时字段类型为枚举类型则为其添加一个sheet用于存放该枚举字段的选项
- 新增支持更新basereport老版本data id的到gse的接口
- 添加接口用于查询实例关联关系以及实例详情
- 新增交换模型属性分组位置的接口
- 接入监控opentelementry
- 支持主机身份生命周期管理能力

**功能优化**
- 平台管理增加业务快照名称修改表单项
- table类型的校验允许类型为interface或map数组
- 转移主机属性自动应用仅判断目标模块
- 禁止创建bk打头的模型，用于后续创建内置模型
- 主机列表支持业务名筛选
- api task的迁移支持status为字符串的情况
- 查询组织全名用于导出主机或实例时替换组织id
- 批量创建模型返回正确结果
- 业务空闲机与资源池解耦
- 主机转移时自动应用调整为按相同的更新数据进行批量更新
- apiserver中新增metric采集项，统计无权限的访问量
- 不允许用户创建bk开头的分组id
- 补充导入组织内容校验
- 创建模型时自动添加的bk_inst_name的唯一索引添加partial filter，防止和定时同步时生成的index冲突
- 创建模型分组和属性接口返回实际创建的数据
- 模型实例权限同步等待db初始化完成后再开始
- 提交事务时若之前没有事务（无db操作的情况下）则跳过提交操作
- 调整前端title和footer，title为蓝鲸智云
- 优化同步主机身份打印的日志

**缺陷修复**
- 修复判断主线父节点忽略内置集群模块时对default进行强制类型转换导致panic的问题
- 修复批量编辑权限申请项目遗漏的问题
- 修复模型字段分组排序失效的问题
- 纠正平台管理中英版错误提示文样式不统一的问题
- 修复无法修改自定义模型字段分组名称的问题
- 修复克隆模板编辑更新时出现数据混乱的问题
- 修复转移主机到其他业务按钮置灰提示样式问题
- 修复查询实例拓扑返回实例中缺少bk_inst_name问题
- 修复在URL中修改业务ID时页面没有切换业务的问题
- 修复前端模型实例权限状态变更后未展示锁的问题
- 修复模板进程id参数类型错误
- 修复集群模板同步历史不展示集群名称和拓扑路径的问题
- 修复excel导入反向实例关联和带/的组织名失败的问题
- 修复watch在正好超时的瞬间产生了一个新事件的情况下丢事件的问题
- 修复导入时获取excel内容逻辑
- 修复当删除服务实例，但模块内的服务实例数不为零场景的同步问题
- 进程绑定信息中的IP统一为必填及调整保存进程信息接口入参
- 修复资源实例批量操作权限限制UI不准确的问题
- 修复模型实例属性修改后不成功的问题
- 修复migrate iam时删除老模型实例action时更新action group失败的问题
- 修复主机身份事件监听失败的问题

## [Version: 3.10.10] - 2021-12-24
**新增功能**
- 提供新接口给资源池的变更记录功能使用，鉴权方式与操作审计不同，根据用户是否有实例查看权限进行鉴权
- 新增平台管理模块
- 首页多IP搜索支持逗号和分号分隔及返回时记住搜索内容
- 服务模板支持克隆
- 支持实例关联事件监听
- 增加支持多个业务的空闲机模块中的主机转移到另外一个业务的空闲机模块
- 事务写冲突时，在场景层进行有策略的重试操作，尽量避免写冲突

**功能优化**
- 添加判断防止导入关联关系时获取对应单元格数据数组越界
- 跨业务转主机的业务选择列表支持按有权限的优先排序
- 增加转移主机时对业务是否归档的判断
- 编辑主机接口性能优化
- 页面转移主机接口调整为按主机最终模块聚合批量转移
- 主机自动应用仅更新有变化的主机
- 禁止内置集群模块通过接口修改
- attribute校验规则添加对table类型的逻辑
- 服务模板同步优化
- 对业务拓扑树进行自然排序
- 迁移校验小工具添加校验和清理无进程关系的进程的功能
- 实例查询接口支持时间查询
- 通用模型实例查看页支持高级筛选

**缺陷修复**
- 修复模型实例鉴权错误的问题(#5846)
- 修复连接zk过程中出现服务注册失败导致服务不可用的问题
- 修复已归档业务小屏幕下操作按钮换行的样式问题
- 修复主机审计获取业务ID失败的问题
- 修复业务批量编辑全选控件错位问题
- 修复业务下属性分组更新时跨业务检验重名问题
- 修复主机属性自动应用拓扑树样式异常
- 修复批量修改业务属性需要点击两次才能修改的问题
- 修复动态分组查询时间问题
- 修复资源目录批量导入实例时报错未提示的问题
- 修复服务模板实例同步状态加载报错的问题
- 修复导入主机判断excel表格数量问题
- 修复导入关联关系返回错误不正确问题
- 修复服务模板新建进程参数类型错误的问题
- 修复导入时获取excel内容逻辑

## [Version: 3.10.9] - 2021-11-22
**功能优化**
- 调整eventserver失败或无事件时等待时间为5秒

**缺陷修复**
- 修复主机搜索时因页码未重置导致无结果的问题
- 修复模型拓扑图“无位置节点”为空时报错导致交互异常问题
- 修复动态分组预览初始页码错误导致无法正确获取数据的问题
- 修复cmdb执行初始化操作报错的问题

## [Version: 3.10.8] - 2021-11-04
**功能优化**
- 优化主机批量导入后台接口逻辑，将主机批量导入接口独立出来，同时优化导入实例后返回结果结构，方便用户识别那些主机异常
- 删除toposerver代码的cores目录
- 添加业务名输入联想组件在主机搜索业务名“包含”条件时使用
- 在更新服务实例标签的时候替换原有的create和delete接口为新的update接口

**缺陷修复**
- 修复服务实例标签编辑会失败的缺陷
- 修复主机自动应用中数据不正确的问题
- 修复实例导入未显示错误详情的问题
- 修复前端业务主机高级筛选页面模糊匹配集群/模块名接口权限解析失败的问题
- 修复删除自定义层级时错误判断子节点节点名重复问题

## [Version: 3.10.7] - 2021-10-27
**新增功能**
- 接口list_service_instance_detail新增支持传入多个hostId
- 新增查询业务的接口支持批量传参
- 新增adminserver支持注册CMDB平台信息到IAM接口

**功能优化**
- 移除v3.9.33版本中服务实例改造中包含的清理存量的无进程服务实例的逻辑
- 调整mongodb的连接池连接空闲超时时间为25分钟
- 主机转移模块限制单次批量转移数量为500
- 业务拓扑左侧树形菜单支持记住上次拉伸位置
- 修改彻底删除业务二次确认触发方式为点击
- 主机资源池表格复制功能优化
- 对诸如业务搜索等未对搜索字符做 trim 处理的进行处理补齐
- 兼容chrome版本升级后部分场景的跨域访问场景(使用后端代理)

**缺陷修复**
- 修复组织选择器初始化未加载组织的问题
- 修复模型字段挪入新建分组时不生效的问题
- 修复新增主机未创建服务实现的问题
- 修复批量跨页选择只有一页时也会展示跨页选择的问题
- 修复主机属性自动应用状态与实际不符

- 修复list_biz_hosts_topo接口如果集群模块条件查询不到时返回全部的问题
- 修复创建业务成功后创建界面未闭问题和优化模型关系编辑拓扑按钮显示
- 修复transfer_host_module这个接口未创建服务实例的问题
- 修复cacheservice中主机身份watch获取toekn异常导致启动失败的问题
- 修复新增自定义层级模型后，业务下集群、主机等模块显示不正确的情况

## [Version: 3.10.6] - 2021-10-11
> 重要提示：
> 1. 新版全文检索升级，请阅读[指引](https://github.com/TencentBlueKing/bk-cmdb/issues/5507)
> 2. 业务拓扑调整，需要在升级完该版本后，利用小工具删除缓存数据，具体详情见issue[#5471](https://github.com/TencentBlueKing/bk-cmdb/issues/5471)）
> 3. 属性鉴权功能，请注意版本依赖：IAM SaaS` >= 1.4.15`，IAM 后台` >=1.7.7`。该版本涉及存量模型实例权限的迁移，如果权限较多执行init_db进行权限迁移的过程可能会持续一段时间，建议在执行权限迁移过程避免执行权限申请和实例操作。

**新增功能**
- 新增清理审计日志接口（接口使用方法可参考issue[#5603](https://github.com/TencentBlueKing/bk-cmdb/issues/5603)）
- 业务支持跨页批量编辑
- 归档业务提供“彻底删除”能力

**功能优化**
- 主机字符字段支持模糊搜索
- 查询集群模板同步状态兼容集群下无模块的情况
- 业务名称搜索默认支持模糊搜索
- taskserver清除一个月之前的冗余任务
- 通用模型内置字段名称统一为不可修改
- 业务名搜索从大小写敏感改成大小写不敏感
- coreservice优化count逻辑
- 优化多值过滤项中IP项溢出隐藏文案展示
- 修复动态分组条件操作符未显示问题
- 修复获取topo节点主机数量接口缺陷
- 修复主机属性自动应用的逻辑失效问题
- 主机与服务实例解耦优化
- 主机和通用模型实例权限申请只显示无权限的实例
- 查询有权限的实例列表功能优化
- toposerver重构
- 修改通用模型名称时，同步模型名到IAM
- 业务拓扑缓存调整（注意：需要在升级完该版本后，利用小工具删除缓存数据，具体详情见issue[#5471](https://github.com/TencentBlueKing/bk-cmdb/issues/5471)）
- 属性鉴权功能中迁移存量模型实例的权限
- 资源导出默认勾选上表头配置的属性列
- 全文检索体验优化
- 主机导出时，默认将业务、自定义层级、集群、模块各放一列导出， 方便用户对这3个模型进行筛选
- 导出实例数据时、通过并发获取用户数据，提高性能
- 主机身份事件监听在watch token里添加id和cursor信息，防止用户用过期的最后一个cursor请求时报错
- “业务” 支持批量编辑合入v3.10.x后的代码优化
- 将服务实例下进程的唯一校验规则放到唯一索引中处理
- 无权限时直接返回空不能提示错误
- 调整代码逻辑以兼容没有任何内置自定义对象的场景

**缺陷修复**
- 修复新建实例自关联的关联关系时对该实例获取两次锁导致失败的问题
- 修复使用主机/服务实例数量统计接口引起的topo创建问题
- 修复资源目录模型实例查询时，查询模式切换混乱的问题
- 修复模型关系新建层级时重复点击创建按钮仍然可以创建的问题
- 修复模型实例详情错误出现loading的问题
- 修复查看单个实例模型删除历史时加载了其他实例删除历史的问题
- 修复运营统计页面数据异常导致显示无权限的问题
- 修复集群模板同步状态会把同步人设置为当前用户的问题
- 修复主线模型事件在redis中找不到详情信息后去db查不到的问题
- 修复对于大量主机（主机数量大于500并且服务模板中进程模板数量大于10）转移场景下的panic问题
- 处理动态分组，字段类型为组织时的校验问题
- 主机数据导出时，如果没有自定义层级时，调整module、set数据的处理
- 修复查询主机删除历史bk_obj_id参数问题
- 修复模块中添加主机在有模板无进程创建服务实例时出错的问题
- 修复运营统计实例图表未显示问题
- 修复动态分组编辑和删除的鉴权，列表中只鉴权了第一个的问题
- 修复自关联模型拓扑数据展示不全的问题
- 修复模块中主机均无服务实例时无法转移到空闲机的问题
- 修复未正确获取进程数据导致无法克隆服务实例到其它主机的问题
- 修复导入模型属性时错误的将id置为0的问题
- 修正主线模型的判断条件，不以业务拓扑分组为判断条件，使该分组下的通用模型能正常同步到IAM
- upgrade添加跳过未注册动作的升级操作
- 修复审计下无法查询动态分组的问题
- 通用模型实例鉴权问题修复
- 修复了同步集群模板实例时事务提交失败导致的报错
- 主机搜索解决输入 \ 字符搜不到的问题

**版本依赖**
- IAM SaaS` >= 1.4.15`
- IAM 后台` >=1.7.7`

## [Version: 3.10.5] - 2021-08-06

**功能优化**
- 模型和主机自关联显示优化

**缺陷修复**
- 修复查询拓扑数量接口在集群下没有模块的情况下传nil查询报错的问题
- 修复集群模板状态表查询逻辑
- 修复批量创建集群名称校验问题
- 仅导出实例的自关联模型，在实例关联了多个模型实例时报错的问题

## [Version: 3.10.4] - 2021-08-02
**新增功能**
- list_biz_hosts接口新增支持按模块属性查询数据，list_biz_hosts_topo接口新增支持按集群、模块属性查数据
- 新增清除冗余task任务记录并设置定时清理机制
- 新增批量获取topo节点主机/服务实例数量的接口，业务拓扑节点主机/服务实例数量异步加载
- 服务模板绑定IP的校验规则放开，允许绑定IP为空。
- 在主机类型枚举中增加Solaris类型
- 取消不允许创建实例自关联限制

**功能优化**
- 获取实例数据时，前端没有传递排序字段时，默认使用实例ID进行排序
- 全部视图下将停用模型放置到同组的末尾
- 首页主机高级搜索跳转到资源主机全部列表页
- 放开首页主机搜索最大500条的限制，调整为1w。 首页主机搜索IP与固资编号混合时可选择其中一种方式搜索
- 更新helm文档
- ip正则校验表达式增加对ip为0.0.0.0的校验
- 删除事件详情的时间类型按json的格式进行序列化
- 模型详情实例数量获取优化

**缺陷修复**
- 修复导出Excel时展示空用户名的问题
- 修复主机详情返回到业务拓扑主机列表条件保留问题
- 修复进程绑定信息校验和显示异常问题
- 修复Excel导入主机更新数据时，如果关联数据为空则导入失败的问题
- 修复新建实例自关联的关联关系时对该实例获取两次锁导致失败的问题

## [Version: 3.10.3] - 2021-07-20

**新增功能**
- 各个模块新增version接口获取版本相关信息
- 前后端统一正则校验方式，统一用后端的正则校验方式进行校验。
- 首页主机搜索添加高级搜索入口跳转到资源主机高级筛选侧滑
- 集群模板拓扑树显示区域加loading
- 禁止主机转移至已经归档的业务
- 事件watch支持通用模型实例事件按模型分类订阅功能
- 事件watch支持主线模型实例事件订阅功能
- 主机的自动发现信息属性分组下的属性调整为可编辑

**功能优化**
- 优化进程模板与实例中进程绑定端口提示
- excel导出数据时，如果数据中的用户在用户管理中不存在时，导出中英文时保留原用户名并提示用户不存在、
- 上报的主机静态数据数据采用新协议时，直接更新主机数据不再校验时间窗口。
- 权限中心移除多余的关联权限(编辑服务实例、删除服务实例)
- 调整拓扑节点名称长度限制为256个字符

**缺陷修复**
- 修复模型关联列表id下划线未完整显示的问题
- 修复主机详情用户类型字段UI显示异常的问题
- 修复重命名云区域时可能出现更新失败的问题
- 修复日期面板偶现的被遮挡问题
- 修复复制主机集群名、模块名不完整的问题
- 修复主机属于多模块时，集群、模块相关字段显示不正确的问题
- 修复取消关联主线模型实例后取消关联失败的问题
- 修复实例关联列表错误的显示了实例自身的问题
- 修复导出实例取消按钮无效的问题
- 修复主机导入时，如果没有实例数据时更新失败的问题

**不兼容提示**
- 批量删除实例接口(batch_delete_inst)添加原来漏掉的鉴权功能，现补充上。加上鉴权后，可能不向下兼容，即原来无权限的用户现在不能正常调用该接口，需要平台和用户关注，如果确实需要删除权限，则直接申请该权限即可。
- 查询业务接口(search_business)接口，当业务不存在时，原来的策略是报错，现不报错，直接返回空。[PR:5473]

## [Version: 3.10.2] - 2021-07-01

**新增功能**
- 小工具增加对redis的操作支持
- 主机的自动发现信息属性字段调整为可编辑
- 服务模板实例标签加同步状态批示提示
- 模型管理页增加“全部”入口
- 实例的关联列表现在支持点击查看详情

**功能优化**
- 业务列表筛选组件切换为通用搜索组件
- 创建集群、模块时，对应模板列表按最后更新时间排序
- 主机自动应用的详情预览拉取数据改为异步加载，提升性能体验
- 主机自动应用的详情预览拉取接口内容瘦身，避免拉取冗余数据
- 新增服务实例，主机和拓扑关系表的2个索引
- 优化显示业务主机追加至业务模块菜单逻辑
- 优化集群模板同步性能，提升交互体验，同时去掉了集群模板及集群表中的version管理字段
- 实例拓扑图视觉和交互优化，解决出现重复节点循环嵌套的问题
- 模型管理页面中的实例数改为按需获取，提升首屏加载性能

**缺陷修复**
- 修复云账户编辑时连通测试通过无法保存的问题
- 修复非业务主机详情选项卡UI异常的问题
- 修复筛选主机并查看详情后返回筛选条件丢失的问题
- 修复创建拓扑自定义层级节点时出现ID字段的问题

## [Version: 3.10.1] - 2021-06-17
> 重要提示：
> 1. v3.10版本为大版本升级，从低于v3.10的版本升级到v3.10版本时，需要**停服**升级，升级过程中会对现有的存量数据进行迁移，升级时间可能会比较长（取决于模型实例的数据量）。
升级前需要用提供的小工具进行数据验证，验证后处理完数据才能进行正常的升级流程。
> 2. 升级前，请仔细阅读这里的[指引](https://github.com/TencentBlueKing/bk-cmdb/issues/5308), 并按照指引中的内容进行升级的的梳理、准备工作。
> 3. `该版本仅为测试版本，不能用于正式环境。`

**新增功能**
- 新增了主机身份事件服务。同时调整了主机身份接口(search_hostidentifier)协议，简化协议内容，性能提升2个量级，具体详情见[这里](https://github.com/TencentBlueKing/bk-cmdb/issues/5183)。(注：该功能依赖GSE的版本, 目前未外发)。
- 新增支持模型实例事件服务功能。
- 新增了一批模型实例查询与count相关的接口，解决老接口存在的性能问题。
- 增加事件上报连通性检测以及升级gsecmdline命令

**功能优化**
- 调整了通用模型实例的底层存储结构，提升通用模型的数据管理能力。
- 调整了模型的唯一校验的管理规则，去掉了允许"空值"不参与唯一校验的特性，使得整个数据在唯一的管理上更为准确，保证数据的准确性。同时调整了可以参与唯一校验的字段规则。
- 优化了资源导入导出的相关逻辑。

**下线功能**
- 下线了"事件订阅"功能的全套服务，由目前的事件watch(ESB接口为resource_watch)服务替代事件服务，新的事件watch服务功能更灵活，服务更稳定，吞吐能量更强。(注：该项依赖GSE的版本>=v1.7.9， 否则可能会导致GSE的gse_syncdata服务无法正常启动)
- 下线了"主机快照"的全套服务及相关接口，该功能的相关能力由蓝鲸监控提供。
- 下线了resource_watch中的set_template资源订阅功能。
- 下线了一批模型实例相关的接口，这些接口存在性能问题，由新上的接口替代。


`新增、调整、下线的接口详情`详见[指引](https://github.com/TencentBlueKing/bk-cmdb/issues/5308)。
